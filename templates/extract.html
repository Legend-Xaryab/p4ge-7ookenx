{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-bold text-center mb-4">Extract Page Tokens</h1>

<form method="post" class="flex flex-col gap-4">
  <input type="text" name="token" placeholder="Enter Facebook User Access Token" 
         class="border p-2 rounded-lg" required>
  <button type="submit" class="bg-purple-600 text-white p-2 rounded-lg hover:scale-105 transition">Extract</button>
</form>

{% if error %}
  <div class="mt-6 p-4 border rounded-lg bg-red-100 text-red-600">
    {{ error }}
  </div>
{% endif %}

{% if pages %}
  <h2 class="text-xl font-semibold mt-6">Pages Found:</h2>
  <ul class="mt-2 space-y-2">
    {% for page in pages %}
      <li class="p-3 border rounded-lg bg-gray-50">
        <strong id="page-name-{{ loop.index }}">{{ page.name }}</strong>
        <button type="button" 
                onclick="copyText('page-name-{{ loop.index }}')" 
                class="ml-2 bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600">Copy Name</button>
        <br>
        Page ID: {{ page.id }}<br>
        Page Token: 
        <code id="token-{{ loop.index }}">{{ page.access_token }}</code>
        <button type="button" 
                onclick="copyText('token-{{ loop.index }}')" 
                class="ml-2 bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600">Copy Token</button>
      </li>
    {% endfor %}
  </ul>
{% endif %}

<script>
function copyText(id) {
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text).then(() => {
    alert("Copied: " + text.substring(0, 30) + "...");
  });
}
</script>
{% endblock %}
